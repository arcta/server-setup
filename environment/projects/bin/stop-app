#!/bin/bash

########################################################################
### stop project node-app if exist
### parameters: $1 project subdirectory
########################################################################
source ~/.local.cnf

if [ -d "$HOME/projects/$1" ]; then

    if [ -f "/etc/nginx/location/app-$1" ]; then
        sudo rm /etc/nginx/upstream/app-$1
        sudo rm /etc/nginx/location/app-$1
        pm2 delete $1
    fi

    sudo systemctl restart nginx
    echo "Stopped $1 NodeJS-App."
else
    echo "Aborting: location projects/$1 does not exist"
fi
